<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>üê¶ Go≈ÇƒÖb i Fizyka 2.0</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(#87CEEB, #dff9fb);
    font-family: "Poppins", Arial, sans-serif;
  }
  canvas {
    display: block;
    margin: 40px auto;
    background: linear-gradient(#aee1f9, #f0f9ff);
    border: 4px solid #2980b9;
    border-radius: 10px;
  }
  #overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255,255,255,0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
  }
  #questionBox {
    position: absolute;
    top: 30%;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    border: 3px solid #2980b9;
    border-radius: 12px;
    padding: 20px;
    width: 300px;
    text-align: center;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    display: none;
  }
  button {
    background: #3498db;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 10px 15px;
    margin: 8px;
    cursor: pointer;
    font-size: 16px;
  }
  button:hover {
    background: #1d6fa5;
  }
</style>
</head>
<body>

<div id="overlay">
  <h1>üê¶ Go≈ÇƒÖb i Fizyka</h1>
  <p>Sterowanie: W ‚Äì g√≥ra, S ‚Äì d√≥≈Ç, A ‚Äì w lewo, D ‚Äì w prawo, Spacja ‚Äì skok</p>
  <button onclick="startGame()">Start gry</button>
</div>

<canvas id="game" width="800" height="400"></canvas>

<div id="questionBox">
  <h3 id="questionText">Pytanie</h3>
  <div id="answers"></div>
</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const overlay = document.getElementById('overlay');

let goleb = {x: 100, y: 200, size: 20, velY: 0, velX: 0};
let gravity = 0.3;
let speed = 4;
let seeds = [];
let obstacles = [];
let score = 0;
let level = 1;
let running = false;
let waitingForAnswer = false;
let keys = {};

const quiz = [
  { q: "JakƒÖ jednostkƒÖ mierzymy si≈Çƒô?", a: ["Niuton", "D≈ºul", "Wat", "Pascal"], correct: 0 },
  { q: "Jak nazywa siƒô przyspieszenie ziemskie?", a: ["g", "v", "p", "f"], correct: 0 },
  { q: "Jak obliczyƒá drogƒô w ruchu jednostajnym?", a: ["s = v¬∑t", "s = a¬∑t¬≤", "s = m¬∑v", "s = F¬∑t"], correct: 0 }
];

function startGame() {
  overlay.style.display = "none";
  running = true;
  resetLevel();
  loop();
}

function newSeed() {
  seeds.push({x: 800, y: Math.random() * 300 + 50, size: 10});
}
function newObstacle() {
  obstacles.push({x: 800, y: Math.random() * 250 + 100, w: 30, h: 60});
}

function drawGoleb() {
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.ellipse(goleb.x, goleb.y, 25, 15, 0, 0, Math.PI*2);
  ctx.fill();
  ctx.fillStyle = "black";
  ctx.beginPath();
  ctx.arc(goleb.x + 10, goleb.y - 5, 3, 0, Math.PI*2);
  ctx.fill();
}

function showQuestion() {
  waitingForAnswer = true;
  document.getElementById('questionBox').style.display = "block";
  let q = quiz[(level - 1) % quiz.length];
  document.getElementById('questionText').textContent = q.q;
  const ansDiv = document.getElementById('answers');
  ansDiv.innerHTML = "";
  q.a.forEach((ans, i) => {
    let btn = document.createElement('button');
    btn.textContent = ans;
    btn.onclick = () => checkAnswer(i === q.correct);
    ansDiv.appendChild(btn);
  });
}

function checkAnswer(correct) {
  if (correct) {
    level++;
    alert("‚úÖ Dobrze! Przechodzisz na poziom " + level);
    document.getElementById('questionBox').style.display = "none";
    waitingForAnswer = false;
    resetLevel();
  } else {
    alert("‚ùå Z≈Ça odpowied≈∫! Spr√≥buj ponownie.");
  }
}

function resetLevel() {
  goleb = {x: 100, y: 200, size: 20, velY: 0, velX: 0};
  seeds = [];
  obstacles = [];
  for (let i=0;i<5;i++){ newSeed(); newObstacle(); }
  score = 0;
}

function moveGoleb() {
  if (keys['w']) goleb.y -= speed;
  if (keys['s']) goleb.y += speed;
  if (keys['a']) goleb.x -= speed;
  if (keys['d']) goleb.x += speed;
  if (keys[' ']) goleb.velY = -6; // spacja - skok
}

function loop() {
  if (!running || waitingForAnswer) return;

  ctx.fillStyle = "#aee1f9";
  ctx.fillRect(0,0,800,400);

  moveGoleb();

  goleb.velY += gravity;
  goleb.y += goleb.velY;
  if (goleb.y > 380) goleb.y = 380;
  if (goleb.y < 0) goleb.y = 0;

  drawGoleb();

  ctx.fillStyle = "saddlebrown";
  seeds.forEach((s, i) => {
    s.x -= 4;
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.size, 0, Math.PI*2);
    ctx.fill();
    if (Math.abs(goleb.x - s.x) < 25 && Math.abs(goleb.y - s.y) < 25) {
      seeds.splice(i,1);
      score++;
      newSeed();
    }
  });

  ctx.fillStyle = "#555";
  obstacles.forEach((o, i) => {
    o.x -= 6;
    ctx.fillRect(o.x, o.y, o.w, o.h);
    if (goleb.x + 25 > o.x && goleb.x - 25 < o.x + o.w &&
        goleb.y + 15 > o.y && goleb.y - 15 < o.y + o.h) {
      running = false;
      overlay.style.display = "flex";
      overlay.innerHTML = `<h1>üí• KONIEC GRY!</h1><p>Tw√≥j wynik: ${score}</p><button onclick="startGame()">Zagraj ponownie</button>`;
    }
  });

  ctx.fillStyle = "black";
  ctx.font = "20px Poppins";
  ctx.fillText("Punkty: " + score, 10, 30);
  ctx.fillText("Poziom: " + level, 680, 30);

  if (score >= 5) {
    running = false;
    showQuestion();
  }

  requestAnimationFrame(loop);
}

// sterowanie
document.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
document.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);
</script>
</body>
</html>
